<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/core-ajax/core-ajax.html">

<polymer-element name="longlat-comp">

    <template>
        <style>
            #simple_loc{
                background-color: lightgray;
            }
        </style>

        <div id="simple_loc">
            <h3>Location Information</h3>
            City:{{city}}<br>
            Url:{{googleMapsURL}}{{city}}<br>
            Status:{{reStatus}}<br>
            Latitude: {{reLat}}<br>
            Longitude:{{reLng}}<br>
            <core-ajax
                    auto
                    url="{{googleMapsURL}}{{city}}"
                    handleAs="json"
                    on-core_error="{{handleError}}"
                    on-core-response="{{handleResponse}}">
            </core-ajax>
        </div>

    </template>
    <script>
        Longlat = Polymer({
            city : "",
            googleMapsURL : "http://maps.googleapis.com/maps/api/geocode/json?address=",
            reStatus : "Not Done",
            reLng : "",
            reLat: "",
            created : function(){
                this.city = this.innerHTML;
            },
            handleError : function(err){
                console.log("ERROR");
                console.log(err);
                alert("Error Handling TODO");
            },
            handleResponse : function(re){
                jsonResponse = JSON.parse(re.detail.xhr.responseText);
                //set status
                this.reStatus = jsonResponse.status;
                //get long+lat from location
                this.reLng = jsonResponse.results[0].geometry.location.lng;
                this.reLat = jsonResponse.results[0].geometry.location.lat;
            }

        });
    </script>
</polymer-element>
