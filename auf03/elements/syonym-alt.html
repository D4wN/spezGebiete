<link rel="import" href="../../bower_components/core-ajax/core-ajax.html">
<polymer-element name="syn-element"  attributes="test">

    <template repeat="{{test in synsets}}">
        <div id="syn">
            <h3>Synonyms for {{test}}: </h3>
            <ul>{{data.name}}</ul><br>

            <core-ajax id="ajax" auto
                       url="https://www.openthesaurus.de/synonyme/search?q={{test}}&format=application/json"
                       handleAs="json">
            </core-ajax>

        </div>

        <style>
            #syn{
                background-color: limegreen;
            }
        </style>

    </template>


    <script>
        Polymer('syn-element',{

            name: true,

            ready: function() {
                this.$.ajax.addEventListener('core-response', function(e){
                    var res = e.detail.response;
                    console.log(res);
                    this.data = {

                        name: getValueOfThesaurus(res.synsets)//res.synsets

                    };

                    function getValueOfThesaurus(elements){
                        var ele = [];
                        var str = "";
                        for (var i = 0; i < elements.length; i++ ){
                            ele.push(elements[i].terms);
                        }
                        for (var j = 0; j < ele.length; j++ ){
                            for(var k = 0; k < ele[j].length; k++){
                                str += ele[j][k].term +", ";
                            }

                        }
                        return str;
                    }
                    this.fire('syn-element-load', {syn: this.data});
                }.bind(this));
            }
        });

    </script>

</polymer-element>